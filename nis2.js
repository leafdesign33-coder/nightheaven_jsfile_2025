javascript:(function(){const M={js:{cryptominers:[/CoinHive\.Worker/,/cryptonight/,/miner\.start/,/webassembly.*mining/i],keyloggers:[/onkeydown.*send.*http/i,/addEventListener.*key.*XMLHttpRequest/i,/KeyLogger/i],formStealers:[/document\.forms.*submit.*send/i,/input.*value.*post/i,/FormGrabber/i],ransomware:[/crypt.*files.*decrypt/i,/AES.*encrypt.*all/i],spyware:[/navigator\.userAgent.*send/,/screen\.width.*post/],redirectors:[/setTimeout.*location\.href/,/window\.onload.*replace/],adware:[/createElement.*script.*ads/,/document\.write.*banner/]},patterns:{obfuscated:[/eval\(.*String\.fromCharCode/,/\\x[0-9a-f]{2}/,/unescape\(.*%/],suspiciousUrls:[/bit\.ly.*exe/,/tinyurl.*js/,/pastebin\.com.*raw/]}};class m{constructor(){this.v="3.0";this.t=[];this.c=[];this.q=[];this.init()}init(){console.log("üõ°Ô∏è Complete Malware Defense v"+this.v+" started");this.blockInstalls();this.startMonitoring();this.fullScan();this.setupBarriers();this.showDashboard()}blockInstalls(){const o=document.createElement;document.createElement=function(e){const t=o.call(document,e);if("script"===e.toLowerCase()){Object.defineProperty(t,"src",{set(e){if(this.detectURL(e))return console.warn("üö´ Blocked:",e),this.log("BLOCKED",e),this;t.src=e}})}return t}.bind(this);window.eval=new Proxy(window.eval,{apply(t,o,a){const n=a[0];return this.detectCode(n)?(console.warn("üö´ Blocked eval"),null):t.apply(o,a)}.bind(this)});window.Function=new Proxy(window.Function,{construct(t,o){const a=o[o.length-1];return this.detectCode(a)?(console.warn("üö´ Blocked Function"),function(){}):new t(...o)}.bind(this)})}detectURL(t){return t&&[/coin-hive/,/crypto-loot/,/minero/,/jsecoin/,/deepminer/,/malware/,/virus/,/\.xyz\//,/\.top\//,/pastebin\.com\/raw/,/bit\.ly.*js/].some(e=>e.test(t.toLowerCase()))}detectCode(t){if(!t)return!1;const o=t.toLowerCase();for(const a in M.js)if(M.js[a].some(t=>t.test(o)))return!0;return M.patterns.obfuscated.some(t=>t.test(o))}log(t,o,a){this.t.push({type:t,source:o,details:a,time:new Date()});return this.t.length}startMonitoring(){const t=window.fetch;window.fetch=function(...o){const[a,n]=o;return this.detectURL(a)?(console.warn("üö´ Blocked fetch:",a),Promise.reject(new Error("Blocked"))):t.apply(this,o)}.bind(this);const o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(t,e){return this.detectURL(e)?(console.warn("üö´ Blocked XHR:",e),this):o.apply(this,arguments)}.bind(this);new MutationObserver(t=>{t.forEach(t=>{t.addedNodes.forEach(o=>{1===o.nodeType&&this.analyzeElement(o)})})}).observe(document.documentElement,{childList:!0,subtree:!0})}analyzeElement(t){if("SCRIPT"===t.tagName){const o=t.src,e=t.textContent;o&&this.detectURL(o)&&(t.remove(),console.log("üóëÔ∏è Removed script:",o));e&&this.detectCode(e)&&(t.remove(),console.log("üóëÔ∏è Removed inline script"))}if("IFRAME"===t.tagName&&t.src&&this.detectURL(t.src)&&(t.remove(),console.log("üóëÔ∏è Removed iframe")),["onclick","onload","onerror"].forEach(o=>{const e=t.getAttribute(o);e&&this.detectCode(e)&&(t.removeAttribute(o),console.log("üóëÔ∏è Removed handler:",o))}),t.href&&this.detectURL(t.href)&&(t.remove(),console.log("üóëÔ∏è Removed link:",t.href)))}fullScan(){console.log("üîç Starting full scan...");this.scanScripts();this.scanStorage();this.scanCookies();this.heuristicScan();this.cleanup();console.log("‚úÖ Scan complete. Threats:",this.t.length)}scanScripts(){document.querySelectorAll("script").forEach(t=>{const o=t.src,e=t.textContent;if(o&&this.detectURL(o))t.remove(),this.c.push("script:"+o),this.log("REMOVED_SCRIPT",o);else if(e&&this.detectCode(e))t.remove(),this.c.push("inline_script"),this.log("REMOVED_INLINE",e.substring(0,100))})}scanStorage(){for(let t=0;t<localStorage.length;t++){const o=localStorage.key(t),e=localStorage.getItem(o);if(this.detectCode(e)||this.isSuspiciousKey(o))this.q.push({type:"storage",key:o,data:e.substring(0,200)}),localStorage.removeItem(o),this.c.push("storage:"+o),this.log("REMOVED_STORAGE",o)}}isSuspiciousKey(t){return[/password/,/token/,/secret/,/key/,/credit.?card/,/auth/].some(o=>o.test(t.toLowerCase()))}scanCookies(){document.cookie.split(";").forEach(t=>{const[o]=t.trim().split("=");if(this.isSuspiciousKey(o)){document.cookie=o+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";this.c.push("cookie:"+o);this.log("REMOVED_COOKIE",o)}})}heuristicScan(){let t=0;const o=performance.now();for(let e=0;e<1e6;e++)t+=Math.random();const a=performance.now()-o;a>100&&(console.warn("‚ö†Ô∏è High CPU usage detected"),this.log("HIGH_CPU","Heuristic",`Loop took ${a.toFixed(2)}ms`));const n=this.checkHiddenElements();n>0&&this.log("HIDDEN_ELEMENTS","Heuristic",`Found ${n} hidden elements`)}checkHiddenElements(){let t=0;return document.querySelectorAll("*").forEach(o=>{const e=getComputedStyle(o);("none"===e.display||"hidden"===e.visibility)&&o.innerHTML&&/malware|mining|keylog/i.test(o.innerHTML)&&(o.remove(),t++,this.log("REMOVED_HIDDEN","DOM",o.tagName))}),t}cleanup(){console.log("üßπ Cleaning...");this.clearMaliciousData();if(this.t.length>5)if(confirm(`Found ${this.t.length} threats! Clear all browser data for this site?`))this.nuclearOption()}clearMaliciousData(){["localStorage","sessionStorage"].forEach(t=>{try{window[t].clear()}catch(o){}});this.clearServiceWorkers()}clearServiceWorkers(){navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then(t=>{t.forEach(t=>{t.unregister();console.log("üóëÔ∏è Unregistered service worker")})})}nuclearOption(){localStorage.clear();sessionStorage.clear();const t=document.cookie.split(";");t.forEach(t=>{const[o]=t.trim().split("=");document.cookie=o+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;"});if("caches"in window)caches.keys().then(t=>{t.forEach(t=>caches.delete(t))});this.clearServiceWorkers();alert("‚ö†Ô∏è All site data cleared! Page will reload.");setTimeout(()=>location.reload(),1000)}setupBarriers(){const t=document.createElement("meta");t.httpEquiv="Content-Security-Policy",t.content="default-src 'self'; script-src 'self'; object-src 'none';",document.head.appendChild(t);const o=document.createElement("meta");o.httpEquiv="X-Frame-Options",o.content="DENY",document.head.appendChild(o);const a=document.createElement("meta");a.httpEquiv="X-XSS-Protection",a.content="1; mode=block",document.head.appendChild(a)}showDashboard(){const t=document.createElement("div");t.style.cssText="position:fixed;top:20px;right:20px;background:#1a1a1a;color:white;border:2px solid #00ff00;border-radius:10px;padding:15px;z-index:99999;font-family:Arial;box-shadow:0 4px 20px rgba(0,0,0,0.5);min-width:250px;",t.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;"><h3 style="margin:0;color:#00ff00;">üõ°Ô∏è Malware Defense</h3><button onclick="this.parentElement.parentElement.remove()" style="background:none;border:none;color:white;cursor:pointer;font-size:20px;">√ó</button></div><div style="margin-bottom:10px;"><div>Status: <span style="color:#00ff00;font-weight:bold;">ACTIVE</span></div><div>Threats blocked: <span style="color:#00aaff;">${this.t.length}</span></div><div>Cleaned: <span style="color:#00aaff;">${this.c.length}</span></div><div>Quarantine: <span style="color:#ffaa00;">${this.q.length}</span></div></div><div style="display:flex;gap:10px;flex-wrap:wrap;"><button onclick="window.malwareDefense.fullScan()" style="background:#0066cc;color:white;border:none;padding:8px;border-radius:5px;cursor:pointer;flex:1;">üîç Rescan</button><button onclick="window.malwareDefense.showReport()" style="background:#333;color:white;border:none;padding:8px;border-radius:5px;cursor:pointer;flex:1;">üìä Report</button><button onclick="if(confirm('Clear ALL data for this site?')) window.malwareDefense.nuclearOption()" style="background:#cc0000;color:white;border:none;padding:8px;border-radius:5px;cursor:pointer;flex:1;">üß® Nuke</button></div>`;document.body.appendChild(t);window.malwareDefense=this}showReport(){const t=document.createElement("div");t.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:100000;display:flex;align-items:center;justify-content:center;",t.innerHTML=`<div style="background:white;color:black;padding:20px;border-radius:10px;max-width:600px;max-height:80vh;overflow-y:auto;"><h2>üîí Security Report</h2><p><strong>Version:</strong> ${this.v}</p><p><strong>Threats Detected:</strong> ${this.t.length}</p><p><strong>Items Cleaned:</strong> ${this.c.length}</p><h3>Recent Threats:</h3><div style="max-height:200px;overflow-y:auto;margin-bottom:20px;">${this.t.slice(-10).map(t=>`<div style="border-bottom:1px solid #ccc;padding:5px 0;"><small>${new Date(t.time).toLocaleTimeString()}</small><br><strong>${t.type}</strong>: ${t.source}</div>`).join("")}</div><h3>Quarantine:</h3><div style="max-height:150px;overflow-y:auto;margin-bottom:20px;">${this.q.slice(-5).map(t=>`<div style="border-bottom:1px solid #ccc;padding:5px 0;"><small>${t.type}</small><br>${t.key}</div>`).join("")}</div><button onclick="this.parentElement.parentElement.remove()" style="background:#0066cc;color:white;border:none;padding:10px 20px;border-radius:5px;cursor:pointer;">Close</button></div>`;document.body.appendChild(t)}}new m();})();
